# ============================================
# ELS LMS Stack - Base Configuration
# ============================================

global:
  imagePullPolicy: IfNotPresent
  namespace: els-lms-stack
  domain: els-lms.local
  
  database:
    host: postgres-postgres.database.svc.cluster.local
    port: 5432
    name: els-lms
    username: postgres
    password: postgres

postgres:
  enabled: true
  
  image:
    repository: postgres
    tag: "15"
    pullPolicy: IfNotPresent

  auth:
    username: postgres
    password: postgres
    database: els-lms
    existingSecret: ""

  service:
    type: ClusterIP
    port: 5432

  persistence:
    enabled: true
    accessModes: ["ReadWriteOnce"]
    size: 2Gi
    storageClassName: "hostpath"

  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

  readinessProbe:
    initialDelaySeconds: 10
    periodSeconds: 5

  livenessProbe:
    initialDelaySeconds: 30
    periodSeconds: 10

els-lms-api:
  enabled: true
  replicaCount: 2

  image:
    repository: harishdell/els-lmsserver
    tag: "1.0"
    pullPolicy: IfNotPresent

  service:
    name: els-lms-api
    type: ClusterIP
    port: 1337
    targetPort: 1337

  env:
    HOST: "0.0.0.0"
    PORT: "1337"
    DATABASE_CLIENT: "postgres"
    DATABASE_HOST: "postgres-postgres"
    DATABASE_PORT: "5432"
    DATABASE_NAME: "els-lms"
    DATABASE_USERNAME: "postgres"
    DATABASE_PASSWORD: "postgres"
    CENTRALIZED_SERVER: "http://els-lms-api.local"

  healthCheck:
    enabled: true
    path: "/_health"
    initialDelaySeconds: 30
    periodSeconds: 10

  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

  ingress:
    enabled: true
    className: nginx
    host: "els-lms-api.local"
    annotations:
      nginx.ingress.kubernetes.io/backend-protocol: "HTTP"
      nginx.ingress.kubernetes.io/rewrite-target: /
    paths:
      - path: /
        pathType: Prefix
els-lms-ui:
  enabled: true
  replicaCount: 1

  image:
    repository: harishdell/els-lms-ui
    tag: "1.1"
    pullPolicy: IfNotPresent

  service:
    name: els-lms-ui
    type: ClusterIP
    port: 80
    targetPort: 80

  env:
    REACT_APP_API_URL: "http://els-lms-api.local/api"
    REACT_APP_ABLY_API_KEY: "xul13A.CNpeww:KkS0rh8M4rJSr5r4gHNGbMijYuxvr90ybz1UQd6uKpw"
    REACT_APP_MAXPAGE: "3"
    REACT_APP_GOOGLE_API_KEY: "REDACTED"

  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 200m
      memory: 256Mi

  ingress:
    enabled: true
    className: nginx
    host: "els-lms-ui.local"
    annotations: {}
    paths:
      - path: /
        pathType: Prefix